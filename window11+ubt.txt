1.Change image sources

sudo vim /etc/apt/sources.list

deb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse


2. 在Windows11上安装ubuntu版linux系统并实现桌面图形化（WSL）
https://blog.csdn.net/zjjlov/article/details/125900597



# 我也使用的wget ,我下载到了home中
wget https://www.python.org/ftp/python/3.9.0/Python-3.9.0.tgz
# 在home中解压
tar -zxf Python-3.9.0.tgz
# 进入python3.9
cd Python-3.9.0
 
# 编译文件  时间大概有1-3分钟
./configure --prefix=/usr/local/python3
 
# 编译好后，会有另外一个提示，让run ./configure xxx
./configure --enable-optimizations
 
# 安装
make && make install
 
# 结束

1、查找到lsb_release模块所在的目录
sudo find / -name 'lsb_release.py'
 
2、将其复制到设置python3.8的系统模块加载位置，也就是报错处subprocess.py所在的目录
sudo cp  /usr/lib/python3/dist-packages/lsb_release.py /usr/local/python3/lib/python3.9/


sudo apt-get update
sudo apt-get upgrade


sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 3B4FE6ACC0B21F32


ln -s ./python ./python2.7*

ln -s ./python3.6* ./python3

pip install "apache-airflow==${AIRFLOW_VERSION}" --constraint "${CONSTRAINT_URL}" -i http://mirrors.aliyun.com/pypi/simple/

阿里云 http://mirrors.aliyun.com/pypi/simple/

中国科技大学 https://pypi.mirrors.ustc.edu.cn/simple/

豆瓣(douban) http://pypi.douban.com/simple/

清华大学 https://pypi.tuna.tsinghua.edu.cn/simple/

中国科学技术大学 http://pypi.mirrors.ustc.edu.cn/simple/

pip install "apache-airflow==${AIRFLOW_VERSION}" --constraint "${CONSTRAINT_URL}" -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host mirrors.aliyun.com

3. 
ssh ip172-18-0-55-csio0u291nsg00ci9q40@direct.labs.play-with-docker.com

4.

docker-compose up -d

docker-compose down

airflow:
 source /usr/bin/airflow_python/bin/activate
 deactivate
home: /opt/airflow

启动:
airflow standalone

关闭：master


 admin  password: 2aYregPnzFCsh69k


airflow users create \
    --username admin \
    --firstname Peter \
    --lastname Parker \
    --role Admin \
    --email spiderman@superhero.org

5.grafana
podman run -d -p 3000:3000 --name=grafana docker.io/grafana/grafana


6.Loki
podman run  -p 3100:3100 --name loki docker.io/grafana/loki v /opt/grafana/loki:/etc/loki v /opt/grafana/loki/loki_config.yaml:/etc/loki/loki_config.yaml -config.file=/etc/loki/loki_config.yaml


server:
  http_listen_port: 3100

schema_config:
  configs:
    - from: 2024-07-01
      store: boltdb
      object_store: filesystem
      schema: v11
      index:
        prefix: index_
        period: 24h

ingester:
  lifecycler:
    address: 127.0.0.1
    ring:
      kvstore:
        store: inmemory
      replication_factor: 1
    final_sleep: 0s
  chunk_idle_period: 5m
  chunk_retain_period: 30s

storage_config:
  boltdb:
    directory: /opt/grafana/promtail/index
  filesystem:
    directory: /opt/grafana/promtail/chunks

limits_config:
  enforce_metric_name: true
  reject_old_samples: true
  reject_old_samples_max_age: 168h
  ingestion_rate_mb: 32
  ingestion_burst_size_mb: 64

chunk_store_config:
  max_look_back_period: 672h


7.promtail
podman run -d -p 3100:3100 --name=promtail docker.io/grafana/promtail -config.file=/etc/promtail/promtail_config.yaml -v /opt/grafana/promtail:/etc/promtail -v /opt/airflow/logs:var/airflow_logs --network host

server:
  http_listen_port: 9080
  grpc_listen_port: 0

positions:
  filename: /tmp/positions.yaml

clients:
  - url: http://127.0.0.1:3100/loki/api/v1/push

scrape_configs:
  - job_name: service_logs
    static_configs:
      - targets:
          - 127.0.0.1
        labels:
          job: dag_1
          __path__: var/airflow_logs/dag_id=example_display*/*/*/*.log
      - targets:
          - 127.0.0.1
        labels:
          job: dag_2
          __path__: var/airflow_logs/dag_id=wx_time_*/*/*/*.log
    pipeline_stages:
      - match:
          selector: '{job="dag_1"} |= "group"'
          stages:
            - multiline:
                firstline: '^\[\d{4}-\d{2}-\d{2}'
                max_wait_time: 3s
            - regex:
                expression: '^\[(?P<times>[-T\d+:.]{28}).*'
            - timestamp:
                format: 2006-01-02T15:04:05-0700
                source: times
                location: Asia/Shanghai
            - labels:
                times:
      - match:
          selector: '{job="dag_2"}'
          stages:
            - multiline:
                firstline: '^\[\d{4}-\d{2}-\d{2}'
                max_wait_time: 3s
            - regex:
                expression: '^\[(?P<times>[-T\d+:.]{28}).*'
            - timestamp:
                format: 2006-01-02T15:04:05-0700
                source: times
                location: Asia/Shanghai
            - labels:
                times:


# 其中username为ubuntu子系统的用户名
# path 为当前文件所在的目录
sudo chown -R root /opt/airflow






99. 打包docker image
# 创建pod
 podman pod create --name mypod
# 将停用的mysql打包为本地镜像
docker commit redis redisimage
# 1. 保存 Docker 镜像
docker save -o mysql.tar mysql:8.0

# 2. 将 tar 文件导入到 Podman
podman load -i mydockerimage.tar

# 3. 验证镜像
podman images

# 5. 运行容器并将其加入到 Pod 中
odman run -d --name podredis --pod mypod mysql:8.0


failed parsing config: /etc/loki/loki_config.yaml: yaml: unmarshal errors:
  line 32: field enforce_metric_name not found in type validation.plain
  line 39: field max_look_back_period not found in type config.ChunkStoreConfig. Use `-config.expand-env=true` flag if you want to expand environment variables in your config file
failed parsing config: /etc/loki/loki_config.yaml: yaml: unmarshal errors:
  line 32: field enforce_metric_name not found in type validation.plain
  line 39: field max_look_back_period not found in type config.ChunkStoreConfig. Use `-config.expand-env=true` flag if you want to expand environment variables in your config file



  [2024-11-01T19:46:36.502+0800]

  (?P<timestamp>[-T])


  [logging] interleave_timestamp_parser



  level=info ts=2024-11-03T10:45:04.091874466Z caller=metrics.go:217 component=frontend org_id=fake traceID=607eed3cd4eb329a latency=fast query="{times=\"dag_1\"}" query_hash=3665245562 query_type=limited range_type=range length=5m0s start_delta=5m53.310868369s end_delta=53.310868479s step=5m0s duration=2.695389ms status=200 limit=10 returned_lines=0 throughput=0B total_bytes=0B total_bytes_structured_metadata=0B lines_per_second=0 total_lines=0 post_filter_lines=0 total_entries=0 store_chunks_download_time=0s queue_time=77µs splits=0 shards=0 query_referenced_structured_metadata=false pipeline_wrapper_filtered_lines=0 chunk_refs_fetch_time=171.653µs cache_chunk_req=0 cache_chunk_hit=0 cache_chunk_bytes_stored=0 cache_chunk_bytes_fetched=0 cache_chunk_download_time=0s cache_index_req=0 cache_index_hit=0 cache_index_download_time=0s cache_stats_results_req=0 cache_stats_results_hit=0 cache_stats_results_download_time=0s cache_volume_results_req=0 cache_volume_results_hit=0 cache_volume_results_download_time=0s cache_result_req=0 cache_result_hit=0 cache_result_download_time=0s cache_result_query_length_served=0s ingester_chunk_refs=0 ingester_chunk_downloaded=0 ingester_chunk_matches=0 ingester_requests=1 ingester_chunk_head_bytes=0B ingester_chunk_compressed_bytes=0B ingester_chunk_decompressed_bytes=0B ingester_post_filter_lines=0 congestion_control_latency=0s index_total_chunks=0 index_post_bloom_filter_chunks=0 index_bloom_filter_ratio=0.00 index_shard_resolver_duration=0s source=datasample disable_pipeline_wrappers=false
level=info ts=2024-11-03T10:45:04.120367975Z caller=roundtrip.go:444 org_id=fake traceID=69f31702442443a3 msg="executing query" type=stats query="{times=\"dag_1\"}" length=5m0s
level=info ts=2024-11-03T10:45:04.121206572Z caller=table_manager.go:189 index-store=tsdb-2024-07-01 msg="get or create table" found=true table=index_20030 wait_for_lock=920ns
ts=2024-11-03T10:45:04.121401955Z caller=spanlogger.go:109 user=fake level=info org_id=fake traceID=69f31702442443a3 caller=metrics.go latency=fast query_type=stats start=2024-11-03T10:40:04Z end=2024-11-03T10:45:04Z start_delta=5m0.121398596s end_delta=121.398756ms length=5m0s duration=279.726µs status=200 query="{times=\"dag_1\"}" query_hash=3665245562 total_entries=1
level=info ts=2024-11-03T10:45:04.121826975Z caller=metrics.go:381 component=frontend org_id=fake traceID=69f31702442443a3 latency=fast query_type=stats start=2024-11-03T10:40:04.091Z end=2024-11-03T10:45:04.091Z start_delta=5m0.030825156s end_delta=30.825326ms length=5m0s duration=1.380634ms status=200 query="{times=\"dag_1\"}" query_hash=3665245562 total_entries=1
level=info ts=2024-11-03T10:45:04.815185535Z caller=roundtrip.go:430 org_id=fake traceID=6e5a8d67ca1bca4c msg="executing query" type=labels label= length=5m0s query=
level=info ts=2024-11-03T10:45:04.816302477Z caller=table_manager.go:189 index-store=tsdb-2024-07-01 msg="get or create table" found=true table=index_20030 wait_for_lock=1.93µs
ts=2024-11-03T10:45:04.816704468Z caller=spanlogger.go:109 user=fake level=info org_id=fake traceID=6e5a8d67ca1bca4c caller=metrics.go latency=fast query_type=labels splits=0 start=2024-11-03T10:40:04.091Z end=2024-11-03T10:45:04.091Z start_delta=5m0.725701059s end_delta=725.701239ms length=5m0s duration=942µs status=200 label= query= query_hash=2166136261 total_entries=4 cache_label_results_req=0 cache_label_results_hit=0 cache_label_results_stored=0 cache_label_results_download_time=0s cache_label_results_query_length_served=0s
level=info ts=2024-11-03T10:45:04.817111906Z caller=metrics.go:263 component=frontend org_id=fake traceID=6e5a8d67ca1bca4c latency=fast query_type=labels splits=0 start=2024-11-03T10:40:04.091Z end=2024-11-03T10:45:04.091Z start_delta=5m0.726109777s end_delta=726.109997ms length=5m0s duration=1.832404ms status=200 label= query= query_hash=2166136261 total_entries=4 cache_label_results_req=0 cache_label_results_hit=0 cache_label_results_stored=0 cache_label_results_download_time=0s cache_label_results_query_length_served=0s
level=info ts=2024-11-03T10:45:05.659383995Z caller=roundtrip.go:430 org_id=fake traceID=62bdfa27edd7ec0f msg="executing query" type=labels label=times length=5m0s query=
level=info ts=2024-11-03T10:45:05.660770806Z caller=table_manager.go:189 index-store=tsdb-2024-07-01 msg="get or create table" found=true table=index_20030 wait_for_lock=1.321µs
ts=2024-11-03T10:45:05.661125712Z caller=spanlogger.go:109 user=fake level=info org_id=fake traceID=62bdfa27edd7ec0f caller=metrics.go latency=fast query_type=labels splits=0 start=2024-11-03T10:40:04.091Z end=2024-11-03T10:45:04.091Z start_delta=5m1.570122131s end_delta=1.570122321s length=5m0s duration=843.267µs status=200 label=times query= query_hash=2166136261 total_entries=17 cache_label_results_req=0 cache_label_results_hit=0 cache_label_results_stored=0 cache_label_results_download_time=0s cache_label_results_query_length_served=0s
level=info ts=2024-11-03T10:45:05.661583211Z caller=metrics.go:263 component=frontend org_id=fake traceID=62bdfa27edd7ec0f latency=fast query_type=labels splits=0 start=2024-11-03T10:40:04.091Z end=2024-11-03T10:45:04.091Z start_delta=5m1.57058116s end_delta=1.57058133s length=5m0s duration=2.105946ms status=200 label=times query= query_hash=2166136261 total_entries=17 cache_label_results_req=0 cache_label_results_hit=0 cache_label_results_stored=0 cache_label_results_download_time=0s cache_label_results_query_length_served=0s
level=info ts=2024-11-03T10:45:17.082014226Z caller=roundtrip.go:376 org_id=fake traceID=05a99f1b4003052b msg="executing query" type=range query="{times=\"2024-11-03T18:00:40.066+0800\"}" start=2024-11-03T10:40:04.091Z end=2024-11-03T10:45:04.091Z start_delta=5m12.991012084s end_delta=12.991012195s length=5m0s step=300000 query_hash=1119877515
level=info ts=2024-11-03T10:45:17.082870907Z caller=table_manager.go:189 index-store=tsdb-2024-07-01 msg="get or create table" found=true table=index_20030 wait_for_lock=10.564µs
ts=2024-11-03T10:45:17.083072593Z caller=spanlogger.go:109 user=fake level=info org_id=fake traceID=05a99f1b4003052b caller=metrics.go latency=fast query_type=stats start=2024-11-03T10:39:34Z end=2024-11-03T10:45:04Z start_delta=5m43.083069889s end_delta=13.08307005s length=5m30s duration=318.34µs status=200 query="{times=\"2024-11-03T18:00:40.066+0800\"}" query_hash=1119877515 total_entries=1
level=info ts=2024-11-03T10:45:17.085052549Z caller=engine.go:250 component=querier org_id=fake traceID=05a99f1b4003052b msg="executing query" type=range query="{times=\"2024-11-03T18:00:40.066+0800\"}" length=5m0s step=5m0s query_hash=1119877515
level=info ts=2024-11-03T10:45:17.085622002Z caller=table_manager.go:189 index-store=tsdb-2024-07-01 msg="get or create table" found=true table=index_20030 wait_for_lock=1.005µs
level=info ts=2024-11-03T10:45:17.086192942Z caller=metrics.go:217 component=querier org_id=fake traceID=05a99f1b4003052b latency=fast query="{times=\"2024-11-03T18:00:40.066+0800\"}" query_hash=1119877515 query_type=limited range_type=range length=5m0s start_delta=5m12.995184418s end_delta=12.995184529s step=5m0s duration=864.543µs status=500 limit=10 returned_lines=0 throughput=0B total_bytes=0B total_bytes_structured_metadata=0B lines_per_second=0 total_lines=0 post_filter_lines=0 total_entries=0 store_chunks_download_time=0s queue_time=550.866µs splits=0 shards=0 query_referenced_structured_metadata=false pipeline_wrapper_filtered_lines=0 chunk_refs_fetch_time=187.512µs cache_chunk_req=0 cache_chunk_hit=0 cache_chunk_bytes_stored=0 cache_chunk_bytes_fetched=0 cache_chunk_download_time=0s cache_index_req=0 cache_index_hit=0 cache_index_download_time=0s cache_stats_results_req=0 cache_stats_results_hit=0 cache_stats_results_download_time=0s cache_volume_results_req=0 cache_volume_results_hit=0 cache_volume_results_download_time=0s cache_result_req=0 cache_result_hit=0 cache_result_download_time=0s cache_result_query_length_served=0s ingester_chunk_refs=0 ingester_chunk_downloaded=0 ingester_chunk_matches=0 ingester_requests=1 ingester_chunk_head_bytes=0B ingester_chunk_compressed_bytes=0B ingester_chunk_decompressed_bytes=0B ingester_post_filter_lines=0 congestion_control_latency=0s index_total_chunks=0 index_post_bloom_filter_chunks=0 index_bloom_filter_ratio=0.00 index_shard_resolver_duration=0s source=datasample disable_pipeline_wrappers=false
level=info ts=2024-11-03T10:45:17.086748131Z caller=metrics.go:217 component=frontend org_id=fake traceID=05a99f1b4003052b latency=fast query="{times=\"2024-11-03T18:00:40.066+0800\"}" query_hash=1119877515 query_type=limited range_type=range length=5m0s start_delta=5m12.995742482s end_delta=12.995742592s step=5m0s duration=4.500616ms status=200 limit=10 returned_lines=0 throughput=0B total_bytes=0B total_bytes_structured_metadata=0B lines_per_second=0 total_lines=0 post_filter_lines=0 total_entries=0 store_chunks_download_time=0s queue_time=551µs splits=0 shards=0 query_referenced_structured_metadata=false pipeline_wrapper_filtered_lines=0 chunk_refs_fetch_time=187.512µs cache_chunk_req=0 cache_chunk_hit=0 cache_chunk_bytes_stored=0 cache_chunk_bytes_fetched=0 cache_chunk_download_time=0s cache_index_req=0 cache_index_hit=0 cache_index_download_time=0s cache_stats_results_req=0 cache_stats_results_hit=0 cache_stats_results_download_time=0s cache_volume_results_req=0 cache_volume_results_hit=0 cache_volume_results_download_time=0s cache_result_req=0 cache_result_hit=0 cache_result_download_time=0s cache_result_query_length_served=0s ingester_chunk_refs=0 ingester_chunk_downloaded=0 ingester_chunk_matches=0 ingester_requests=1 ingester_chunk_head_bytes=0B ingester_chunk_compressed_bytes=0B ingester_chunk_decompressed_bytes=0B ingester_post_filter_lines=0 congestion_control_latency=0s index_total_chunks=0 index_post_bloom_filter_chunks=0 index_bloom_filter_ratio=0.00 index_shard_resolver_duration=0s source=datasample disable_pipeline_wrappers=false
level=info ts=2024-11-03T10:45:17.110574576Z caller=roundtrip.go:444 org_id=fake traceID=6b4a1b132bb5cefc msg="executing query" type=stats query="{times=\"2024-11-03T18:00:40.066+0800\"}" length=5m0s
level=info ts=2024-11-03T10:45:17.11130453Z caller=table_manager.go:189 index-store=tsdb-2024-07-01 msg="get or create table" found=true table=index_20030 wait_for_lock=915ns
ts=2024-11-03T10:45:17.111498888Z caller=spanlogger.go:109 user=fake level=info org_id=fake traceID=6b4a1b132bb5cefc caller=metrics.go latency=fast query_type=stats start=2024-11-03T10:40:17Z end=2024-11-03T10:45:17Z start_delta=5m0.111494847s end_delta=111.494968ms length=5m0s duration=256.661µs status=200 query="{times=\"2024-11-03T18:00:40.066+0800\"}" query_hash=1119877515 total_entries=1
level=info ts=2024-11-03T10:45:17.111860905Z caller=metrics.go:381 component=frontend org_id=fake traceID=6b4a1b132bb5cefc latency=fast query_type=stats start=2024-11-03T10:40:17.082Z end=2024-11-03T10:45:17.082Z start_delta=5m0.029857789s end_delta=29.85796ms length=5m0s duration=1.201802ms status=200 query="{times=\"2024-11-03T18:00:40.066+0800\"}" query_hash=1119877515 total_entries=1
level=info ts=2024-11-03T10:45:19.116737226Z caller=roundtrip.go:376 org_id=fake traceID=67f655fcd8866f02 msg="executing query" type=range query="{times=\"2024-11-03T18:00:40.066+0800\"}" start=2024-11-03T10:40:19.11Z end=2024-11-03T10:45:19.11Z start_delta=5m0.006735094s end_delta=6.735195ms length=5m0s step=100 query_hash=1119877515
level=info ts=2024-11-03T10:45:19.117527998Z caller=table_manager.go:189 index-store=tsdb-2024-07-01 msg="get or create table" found=true table=index_20030 wait_for_lock=1.136µs
ts=2024-11-03T10:45:19.118340338Z caller=spanlogger.go:109 user=fake level=info org_id=fake traceID=67f655fcd8866f02 caller=metrics.go latency=fast query_type=stats start=2024-11-03T10:39:49Z end=2024-11-03T10:45:19Z start_delta=5m30.118336839s end_delta=118.33707ms length=5m30s duration=874.712µs status=200 query="{times=\"2024-11-03T18:00:40.066+0800\"}" query_hash=1119877515 total_entries=1
level=info ts=2024-11-03T10:45:19.119228462Z caller=engine.go:250 component=querier org_id=fake traceID=67f655fcd8866f02 msg="executing query" type=range query="{times=\"2024-11-03T18:00:40.066+0800\"}" length=5m0s step=100ms query_hash=1119877515
level=info ts=2024-11-03T10:45:19.119707319Z caller=table_manager.go:189 index-store=tsdb-2024-07-01 msg="get or create table" found=true table=index_20030 wait_for_lock=975ns
level=info ts=2024-11-03T10:45:19.119972127Z caller=metrics.go:217 component=querier org_id=fake traceID=67f655fcd8866f02 latency=fast query="{times=\"2024-11-03T18:00:40.066+0800\"}" query_hash=1119877515 query_type=limited range_type=range length=5m0s start_delta=5m0.009963761s end_delta=9.963871ms step=100ms duration=690.987µs status=500 limit=1000 returned_lines=0 throughput=0B total_bytes=0B total_bytes_structured_metadata=0B lines_per_second=0 total_lines=0 post_filter_lines=0 total_entries=0 store_chunks_download_time=0s queue_time=113.581µs splits=0 shards=0 query_referenced_structured_metadata=false pipeline_wrapper_filtered_lines=0 chunk_refs_fetch_time=113.952µs cache_chunk_req=0 cache_chunk_hit=0 cache_chunk_bytes_stored=0 cache_chunk_bytes_fetched=0 cache_chunk_download_time=0s cache_index_req=0 cache_index_hit=0 cache_index_download_time=0s cache_stats_results_req=0 cache_stats_results_hit=0 cache_stats_results_download_time=0s cache_volume_results_req=0 cache_volume_results_hit=0 cache_volume_results_download_time=0s cache_result_req=0 cache_result_hit=0 cache_result_download_time=0s cache_result_query_length_served=0s ingester_chunk_refs=0 ingester_chunk_downloaded=0 ingester_chunk_matches=0 ingester_requests=1 ingester_chunk_head_bytes=0B ingester_chunk_compressed_bytes=0B ingester_chunk_decompressed_bytes=0B ingester_post_filter_lines=0 congestion_control_latency=0s index_total_chunks=0 index_post_bloom_filter_chunks=0 index_bloom_filter_ratio=0.00 index_shard_resolver_duration=0s disable_pipeline_wrappers=false
level=info ts=2024-11-03T10:45:19.120533907Z caller=metrics.go:217 component=frontend org_id=fake traceID=67f655fcd8866f02 latency=fast query="{times=\"2024-11-03T18:00:40.066+0800\"}" query_hash=1119877515 query_type=limited range_type=range length=5m0s start_delta=5m0.010526979s end_delta=10.52709ms step=100ms duration=3.515916ms status=200 limit=1000 returned_lines=0 throughput=0B total_bytes=0B total_bytes_structured_metadata=0B lines_per_second=0 total_lines=0 post_filter_lines=0 total_entries=0 store_chunks_download_time=0s queue_time=114µs splits=0 shards=0 query_referenced_structured_metadata=false pipeline_wrapper_filtered_lines=0 chunk_refs_fetch_time=113.952µs cache_chunk_req=0 cache_chunk_hit=0 cache_chunk_bytes_stored=0 cache_chunk_bytes_fetched=0 cache_chunk_download_time=0s cache_index_req=0 cache_index_hit=0 cache_index_download_time=0s cache_stats_results_req=0 cache_stats_results_hit=0 cache_stats_results_download_time=0s cache_volume_results_req=0 cache_volume_results_hit=0 cache_volume_results_download_time=0s cache_result_req=0 cache_result_hit=0 cache_result_download_time=0s cache_result_query_length_served=0s ingester_chunk_refs=0 ingester_chunk_downloaded=0 ingester_chunk_matches=0 ingester_requests=1 ingester_chunk_head_bytes=0B ingester_chunk_compressed_bytes=0B ingester_chunk_decompressed_bytes=0B ingester_post_filter_lines=0 congestion_control_latency=0s index_total_chunks=0 index_post_bloom_filter_chunks=0 index_bloom_filter_ratio=0.00 index_shard_resolver_duration=0s disable_pipeline_wrappers=false
level=info ts=2024-11-03T10:45:19.12062416Z caller=roundtrip.go:376 org_id=fake traceID=12f8e098be9a1c86 msg="executing query" type=range query="sum by (level, detected_level) (count_over_time({times=\"2024-11-03T18:00:40.066+0800\"} | drop __error__[1s]))" start=2024-11-03T10:40:19Z end=2024-11-03T10:45:19.11Z start_delta=5m0.120622471s end_delta=10.622662ms length=5m0.11s step=1000 query_hash=2304006056
level=info ts=2024-11-03T10:45:19.121366176Z caller=table_manager.go:189 index-store=tsdb-2024-07-01 msg="get or create table" found=true table=index_20030 wait_for_lock=925ns
ts=2024-11-03T10:45:19.121617208Z caller=spanlogger.go:109 user=fake level=info org_id=fake traceID=12f8e098be9a1c86 caller=metrics.go latency=fast query_type=stats start=2024-11-03T10:40:18Z end=2024-11-03T10:45:20Z start_delta=5m1.121614342s end_delta=-878.385477ms length=5m2s duration=280.292µs status=200 query="{times=\"2024-11-03T18:00:40.066+0800\"}" query_hash=1119877515 total_entries=1
level=info ts=2024-11-03T10:45:19.123409353Z caller=engine.go:250 component=querier org_id=fake traceID=12f8e098be9a1c86 msg="executing query" type=range query="sum by (level,detected_level)(count_over_time({times=\"2024-11-03T18:00:40.066+0800\"} | drop __error__[1s]))" length=5m1s step=1s query_hash=763768768
level=info ts=2024-11-03T10:45:19.123901673Z caller=table_manager.go:189 index-store=tsdb-2024-07-01 msg="get or create table" found=true table=index_20030 wait_for_lock=1.287µs
level=info ts=2024-11-03T10:45:19.124325992Z caller=metrics.go:217 component=querier org_id=fake traceID=12f8e098be9a1c86 latency=fast query="sum by (level,detected_level)(count_over_time({times=\"2024-11-03T18:00:40.066+0800\"} | drop __error__[1s]))" query_hash=763768768 query_type=metric range_type=range length=5m1s start_delta=5m0.124317637s end_delta=-875.682253ms step=1s duration=862.534µs status=500 limit=100 returned_lines=0 throughput=0B total_bytes=0B total_bytes_structured_metadata=0B lines_per_second=0 total_lines=0 post_filter_lines=0 total_entries=0 store_chunks_download_time=0s queue_time=69.731µs splits=0 shards=0 query_referenced_structured_metadata=false pipeline_wrapper_filtered_lines=0 chunk_refs_fetch_time=140.81µs cache_chunk_req=0 cache_chunk_hit=0 cache_chunk_bytes_stored=0 cache_chunk_bytes_fetched=0 cache_chunk_download_time=0s cache_index_req=0 cache_index_hit=0 cache_index_download_time=0s cache_stats_results_req=0 cache_stats_results_hit=0 cache_stats_results_download_time=0s cache_volume_results_req=0 cache_volume_results_hit=0 cache_volume_results_download_time=0s cache_result_req=0 cache_result_hit=0 cache_result_download_time=0s cache_result_query_length_served=0s ingester_chunk_refs=0 ingester_chunk_downloaded=0 ingester_chunk_matches=0 ingester_requests=1 ingester_chunk_head_bytes=0B ingester_chunk_compressed_bytes=0B ingester_chunk_decompressed_bytes=0B ingester_post_filter_lines=0 congestion_control_latency=0s index_total_chunks=0 index_post_bloom_filter_chunks=0 index_bloom_filter_ratio=0.00 index_shard_resolver_duration=0s source=logvolhist disable_pipeline_wrappers=false
level=info ts=2024-11-03T10:45:19.125086559Z caller=metrics.go:217 component=frontend org_id=fake traceID=12f8e098be9a1c86 latency=fast query="sum by (level, detected_level) (count_over_time({times=\"2024-11-03T18:00:40.066+0800\"} | drop __error__[1s]))" query_hash=2304006056 query_type=metric range_type=range length=5m0.11s start_delta=5m0.125079702s end_delta=15.079812ms step=1s duration=4.191679ms status=200 limit=100 returned_lines=0 throughput=0B total_bytes=0B total_bytes_structured_metadata=0B lines_per_second=0 total_lines=0 post_filter_lines=0 total_entries=0 store_chunks_download_time=0s queue_time=69.731µs splits=0 shards=1 query_referenced_structured_metadata=false pipeline_wrapper_filtered_lines=0 chunk_refs_fetch_time=140.81µs cache_chunk_req=0 cache_chunk_hit=0 cache_chunk_bytes_stored=0 cache_chunk_bytes_fetched=0 cache_chunk_download_time=0s cache_index_req=0 cache_index_hit=0 cache_index_download_time=0s cache_stats_results_req=0 cache_stats_results_hit=0 cache_stats_results_download_time=0s cache_volume_results_req=0 cache_volume_results_hit=0 cache_volume_results_download_time=0s cache_result_req=0 cache_result_hit=0 cache_result_download_time=0s cache_result_query_length_served=0s ingester_chunk_refs=0 ingester_chunk_downloaded=0 ingester_chunk_matches=0 ingester_requests=1 ingester_chunk_head_bytes=0B ingester_chunk_compressed_bytes=0B ingester_chunk_decompressed_bytes=0B ingester_post_filter_lines=0 congestion_control_latency=0s index_total_chunks=0 index_post_bloom_filter_chunks=0 index_bloom_filter_ratio=0.00 index_shard_resolver_duration=0s source=logvolhist disable_pipeline_wrappers=false